var l=(s,e,t)=>new Promise((c,i)=>{var r=a=>{try{o(t.next(a))}catch(n){i(n)}},d=a=>{try{o(t.throw(a))}catch(n){i(n)}},o=a=>a.done?c(a.value):Promise.resolve(a.value).then(r,d);o((t=t.apply(s,e)).next())});import{renderListWithTemplate as u,getLocalStorage as m}from"./utils.js";import{removeFromCart as y,changeQuantity as _}from"./cart.js";export default class q{constructor(e,t){this.key=e,this.listElement=t}init(){return l(this,null,function*(){const e=m(this.key);this.renderList(e)})}prepareTemplate(e,t){return e.querySelector(".cart-card__image img").src=t.CartImage,e.querySelector(".cart-card__image img").alt+=t.Name,e.querySelector(".card__name").textContent=t.Name,e.querySelector(".cart-card__color").textContent=t.SelectedColor,e.querySelector(".cart-card__remove").setAttribute("id",t.Id),e.querySelector(".cart-card__quantity").value=t.qty,e.querySelector(".cart-card__quantity").setAttribute("id",t.Id),e.querySelector(".cart-card__price").textContent+=t.FinalPrice,e}renderTotal(e){document.querySelector(".cart-footer").classList.remove("hide"),document.querySelector(".cart-total").innerHTML=`Total: $${e}`}renderCheckoutButton(){document.querySelector(".checkout").classList.remove("hide")}renderList(e){this.listElement.innerHTML="";const t=document.getElementById("cart-card-template");u(t,this.listElement,e,this.prepareTemplate);let c=0;for(var i of e)c+=i.FinalPrice*i.qty;c>0&&(this.renderTotal(c.toFixed(2)),this.renderCheckoutButton()),document.querySelector(".product-list").addEventListener("click",function(r){r.target.classList=="cart-card__remove"&&y(r.target.id)}),document.querySelector(".product-list").addEventListener("change",function(r){r.target.classList=="cart-card__quantity"&&_(r.target.id,r.target.value)})}}
