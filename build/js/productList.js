var o=(c,e,t)=>new Promise((r,n)=>{var d=i=>{try{s(t.next(i))}catch(a){n(a)}},l=i=>{try{s(t.throw(i))}catch(a){n(a)}},s=i=>i.done?r(i.value):Promise.resolve(i.value).then(d,l);s((t=t.apply(c,e)).next())});import{renderListWithTemplate as u}from"./utils.js";import{displayProductListingBreadcrumbs as m}from"./breadcrumbs.js";export default class h{constructor(e,t,r){this.category=e,this.dataSource=t,this.listElement=r}init(){return o(this,null,function*(){const e=yield this.dataSource.getData(this.category);m(this.category,e.length),this.renderList(e)})}renderList(e){this.listElement.innerHTML="";const t=document.getElementById("product-card-template");document.querySelector(".title").innerHTML=this.category,u(t,this.listElement,e,this.prepareTemplate)}prepareTemplate(e,t){let r=window.location.href,n=r.indexOf("/product-listing");return r=r.substring(0,n)+"/product_pages/product-details.html?product="+t.Id,e.querySelector("a").href=r,e.querySelector("img").src=t.Images.PrimaryMedium,e.querySelector("img").alt+=t.Name,e.querySelector(".card__brand").textContent=t.Brand.Name,e.querySelector(".card__name").textContent=t.NameWithoutBrand,e.querySelector(".product-card__price").textContent+=t.FinalPrice,e.querySelector(".card__discount").textContent=Math.round((1-t.FinalPrice/t.SuggestedRetailPrice)*100)+"% off",e}}
